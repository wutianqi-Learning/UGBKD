2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_setup.py:_flush():76] Configure stats pid to 1000685
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_setup.py:_flush():76] Loading settings from /home/s316/.config/wandb/settings
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_setup.py:_flush():76] Loading settings from /home/s316/workspace2/zhangdw/monai_mmengine/wandb/settings
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'mode': 'offline'}
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'test.py', 'program': '/home/s316/workspace2/zhangdw/monai_mmengine/test.py'}
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_init.py:_log_setup():507] Logging user logs to /home/s316/workspace2/zhangdw/monai_mmengine/save_dirs/unetmod_tiny_d8_300e_sgd_word_96x96x96/20240603_181227/vis_data/wandb/offline-run-20240603_181228-xyjf0g50/logs/debug.log
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_init.py:_log_setup():508] Logging internal logs to /home/s316/workspace2/zhangdw/monai_mmengine/save_dirs/unetmod_tiny_d8_300e_sgd_word_96x96x96/20240603_181227/vis_data/wandb/offline-run-20240603_181228-xyjf0g50/logs/debug-internal.log
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_init.py:init():547] calling init triggers
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_init.py:init():595] starting backend
2024-06-03 18:12:28,308 INFO    MainThread:1000685 [wandb_init.py:init():599] setting up manager
2024-06-03 18:12:28,309 INFO    MainThread:1000685 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-06-03 18:12:28,310 INFO    MainThread:1000685 [wandb_init.py:init():605] backend started and connected
2024-06-03 18:12:28,312 INFO    MainThread:1000685 [wandb_init.py:init():695] updated telemetry
2024-06-03 18:12:28,312 INFO    MainThread:1000685 [wandb_init.py:init():782] starting run threads in backend
2024-06-03 18:12:28,390 INFO    MainThread:1000685 [wandb_run.py:_console_start():2157] atexit reg
2024-06-03 18:12:28,391 INFO    MainThread:1000685 [wandb_run.py:_redirect():2012] redirect: SettingsConsole.WRAP_RAW
2024-06-03 18:12:28,391 INFO    MainThread:1000685 [wandb_run.py:_redirect():2077] Wrapping output streams.
2024-06-03 18:12:28,391 INFO    MainThread:1000685 [wandb_run.py:_redirect():2102] Redirects installed.
2024-06-03 18:12:28,393 INFO    MainThread:1000685 [wandb_init.py:init():824] run started, returning control to user process
2024-06-03 18:12:28,396 INFO    MainThread:1000685 [wandb_run.py:_config_callback():1285] config_cb None None {'roi': [96, 96, 96], 'dataloader_cfg': {'data_name': 'WORD', 'data_dir': 'data/WORD', 'json_list': 'dataset.json', 'train_case_nums': 100, 'meta_info': 'seg.datasets.monai_dataset.WORD_METAINFO', 'use_normal_dataset': True, 'use_smart_dataset': False, 'batch_size': 1, 'num_samples': 4, 'workers': 2, 'distributed': False, 'space_x': 1.5, 'space_y': 1.5, 'space_z': 2.0, 'a_min': -175.0, 'a_max': 250, 'b_min': 0.0, 'b_max': 1.0, 'roi_x': 96, 'roi_y': 96, 'roi_z': 96, 'RandFlipd_prob': 0.2, 'RandRotate90d_prob': 0.2, 'RandScaleIntensityd_prob': 0.1, 'RandShiftIntensityd_prob': 0.1, 'use_test_data': False}, 'val_evaluator': {'type': 'seg.evaluation.monai_evaluator.MonaiEvaluator', 'metrics': {'type': 'seg.evaluation.metrics.monai_metric.MonaiMetric', 'metrics': ['Dice', 'HD95'], 'num_classes': 17}}, 'test_evaluator': {'type': 'seg.evaluation.monai_evaluator.MonaiEvaluator', 'metrics': {'type': 'seg.evaluation.metrics.monai_metric.MonaiMetric', 'metrics': ['Dice', 'HD95'], 'num_classes': 17}}, 'train_cfg': {'type': 'mmengine.runner.loops.EpochBasedTrainLoop', 'max_epochs': 300, 'val_begin': 100, 'val_interval': 25}, 'val_cfg': {'type': 'seg.engine.runner.monai_loops.MonaiValLoop'}, 'test_cfg': {'type': 'seg.engine.runner.monai_loops.MonaiTestLoop'}, 'optimizer': {'type': 'torch.optim.SGD', 'lr': 0.01, 'momentum': 0.9, 'weight_decay': 0.0005}, 'optim_wrapper': {'type': 'mmengine.optim.OptimWrapper', 'optimizer': {'type': 'torch.optim.SGD', 'lr': 0.01, 'momentum': 0.9, 'weight_decay': 0.0005}, 'clip_grad': None}, 'param_scheduler': [{'type': 'mmengine.optim.scheduler.PolyLR', 'eta_min': 1e-06, 'power': 0.9, 'begin': 0, 'end': 300, 'by_epoch': True}], 'default_hooks': {'timer': {'type': 'mmengine.hooks.IterTimerHook'}, 'logger': {'type': 'seg.engine.hooks.logger_hook.MyLoggerHook', 'interval': 10, 'val_interval': 1}, 'param_scheduler': {'type': 'mmengine.hooks.ParamSchedulerHook'}, 'checkpoint': {'type': 'seg.engine.hooks.MyCheckpointHook', 'by_epoch': True, 'interval': 25, 'max_keep_ckpts': 1, 'save_best': ['Dice'], 'rule': 'greater'}, 'sampler_seed': {'type': 'mmengine.hooks.DistSamplerSeedHook'}, 'visualization': {'type': 'mmseg.engine.hooks.SegVisualizationHook'}}, 'custom_hooks': [{'type': 'seg.engine.hooks.empty_cache_hook.EmptyCacheHook', 'before_epoch': False, 'after_epoch': True, 'after_iter': False}], 'runner_type': 'seg.engine.runner.monai_runner.MonaiRunner', 'default_scope': None, 'env_cfg': {'cudnn_benchmark': True, 'mp_cfg': {'mp_start_method': 'fork', 'opencv_num_threads': 0}, 'dist_cfg': {'backend': 'nccl'}}, 'vis_backends': [{'type': 'mmengine.visualization.vis_backend.LocalVisBackend'}, {'type': 'mmengine.visualization.vis_backend.WandbVisBackend', 'init_kwargs': {'project': 'word', 'name': 'unet-tiny-sgd-300e'}, 'define_metric_cfg': {'Dice': 'max'}}], 'visualizer': {'type': 'mmseg.visualization.local_visualizer.SegLocalVisualizer', 'vis_backends': [{'type': 'mmengine.visualization.vis_backend.LocalVisBackend'}, {'type': 'mmengine.visualization.vis_backend.WandbVisBackend', 'init_kwargs': {'project': 'word', 'name': 'unet-tiny-sgd-300e'}, 'define_metric_cfg': {'Dice': 'max'}}], 'name': 'visualizer'}, 'log_processor': {'by_epoch': True}, 'log_level': 'INFO', 'load_from': 'ckpts/unetmod_tiny_d8_300e_sgd_word_96x96x96/best_Dice_76-40_epoch_300.pth', 'resume': False, 'test_mode': True, 'save': True, 'model': {'type': 'seg.models.segmentors.monai_model.MonaiSeg', 'num_classes': 17, 'roi_shapes': [96, 96, 96], 'backbone': {'type': 'seg.models.unet.monai_unet_mod.UNetMod', 'spatial_dims': 3, 'in_channels': 1, 'out_channels': 17, 'channels': [32, 64, 128, 256], 'strides': [2, 2, 2], 'num_res_units': 0}, 'loss_functions': {'type': 'monai.losses.DiceCELoss', 'to_onehot_y': True, 'softmax': True}, 'infer_cfg': {'inf_size': [96, 96, 96], 'sw_batch_size': 4, 'infer_overlap': 0.5}}, 'launcher': 'none', 'work_dir': './save_dirs/unetmod_tiny_d8_300e_sgd_word_96x96x96'}
2024-06-03 18:13:33,193 WARNING MsgRouterThr:1000685 [router.py:message_loop():77] message_loop has been closed
